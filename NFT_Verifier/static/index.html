<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NFT Verifier</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
      :root {
        --primary: #ff6f61; /* Coral for primary elements */
        --primary-hover: #ff4f40; /* Darker coral for hover */
        --secondary: #4a90e2; /* Soft blue for secondary elements */
        --text: #e0e0e0; /* Light gray for text */
        --error: #ff4d4d; /* Red for errors */
        --success: #39ff14; /* Neon green for success */
        --warning: #ffaa00; /* Orange for warnings */
        --background: #0d1a26; /* Deep space blue-black background */
        --card-bg: #1a2b3c; /* Darker card background with a subtle blue tint */
        --border: #2a3b4c; /* Subtle border color */
        --glow: 0 0 10px #ff6f61, 0 0 20px #ff6f61, 0 0 30px #ff6f61;
        --gradient: linear-gradient(135deg, #0d1a26 0%, #1a2b3c 100%);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Poppins", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: var(--gradient);
        color: var(--text);
        line-height: 1.6;
        font-size: 16px;
        position: relative;
        overflow-x: hidden;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      /* Space-inspired background with subtle particles */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
        background-size: 50px 50px;
        opacity: 0.3;
        z-index: -1;
        animation: floatParticles 20s linear infinite;
      }

      @keyframes floatParticles {
        0% { background-position: 0 0; }
        100% { background-position: 50px 50px; }
      }

      .container {
        max-width: 1280px;
        margin: 0 auto;
        padding: 3rem 1.5rem;
        position: relative;
        z-index: 1;
        flex: 1;
      }

      header {
        text-align: center;
        padding: 2rem;
      }

      h1 {
        font-family: "Orbitron", sans-serif;
        font-size: 4rem;
        font-weight: 700;
        background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin: 0;
        letter-spacing: 0.15em;
        text-transform: uppercase;
        text-shadow: 0 0 15px rgba(255, 111, 97, 0.7), 
                     0 0 30px rgba(74, 144, 226, 0.5), 
                     0 2px 5px rgba(0, 0, 0, 0.5); /* Adds a 3D effect */
        animation: neonFlicker 3s infinite alternate;
      }

      @keyframes neonFlicker {
        0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
          text-shadow: 0 0 15px rgba(255, 111, 97, 0.7), 
                       0 0 30px rgba(74, 144, 226, 0.5), 
                       0 2px 5px rgba(0, 0, 0, 0.5);
          opacity: 1;
        }
        20%, 24%, 55% {
          text-shadow: 0 0 5px rgba(255, 111, 97, 0.3), 
                       0 0 10px rgba(74, 144, 226, 0.2), 
                       0 2px 5px rgba(0, 0, 0, 0.5);
          opacity: 0.8;
        }
      }

      .tabs {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin: 2rem 0;
        padding: 0.5rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        border: 1px solid var(--border);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      }

      .tab {
        padding: 0.75rem 2rem;
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text);
        background: none;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .tab:hover {
        color: var(--primary);
        background: rgba(255, 111, 97, 0.1);
        box-shadow: 0 2px 10px rgba(255, 111, 97, 0.3);
      }

      .tab.active {
        color: white;
        background: var(--primary);
        box-shadow: 0 2px 10px rgba(255, 111, 97, 0.5);
      }

      .tab-content {
        display: none;
        background: var(--card-bg);
        padding: 2rem;
        border-radius: 12px;
        border: 1px solid var(--border);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        animation: slideIn 0.5s ease;
      }

      .tab-content.active {
        display: block;
      }

      @keyframes slideIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .form-group {
        margin-bottom: 1.75rem;
      }

      label {
        font-weight: 600;
        margin-bottom: 0.5rem;
        display: block;
        color: var(--primary);
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      input[type="text"] {
        width: 100%;
        padding: 0.875rem 1.25rem;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 1rem;
        background: #121212;
        color: var(--text);
        transition: all 0.3s ease;
      }

      input[type="text"]:focus {
        border-color: var(--primary);
        box-shadow: 0 0 10px rgba(255, 111, 97, 0.5);
        outline: none;
      }

      button {
        background: var(--primary);
        color: white;
        padding: 0.875rem 2rem;
        border: none;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255, 111, 97, 0.4);
      }

      button:hover:not(:disabled) {
        background: var(--primary-hover);
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(255, 111, 97, 0.6);
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        box-shadow: none;
      }

      .result {
        margin-top: 2.5rem;
        display: none;
      }

      .result h2 {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border);
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      .error {
        color: var(--error);
        FONT-WEIGHT: 500;
        margin-top: 0.75rem;
        text-shadow: 0 0 5px rgba(255, 77, 77, 0.3);
      }

      .success {
        color: var(--success);
        text-shadow: 0 0 5px rgba(57, 255, 20, 0.3);
      }

      .warning {
        color: var(--warning);
        text-shadow: 0 0 5px rgba(255, 170, 0, 0.3);
      }

      .loading {
        display: none;
        text-align: center;
        padding: 2rem;
      }

      .loading-spinner {
        width: 48px;
        height: 48px;
        border: 4px solid var(--border);
        border-top-color: var(--primary);
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
        margin-bottom: 1rem;
        box-shadow: 0 0 10px rgba(255, 111, 97, 0.5);
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      .nft-card {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 1.75rem;
        margin-bottom: 1.5rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      .nft-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(255, 111, 97, 0.3);
      }

      .nft-card h3 {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--primary);
        margin: 0 0 1rem;
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      pre {
        background: #121212;
        padding: 1rem;
        border-radius: 8px;
        font-size: 0.9rem;
        overflow-x: auto;
        color: var(--text);
        border: 1px solid var(--border);
      }

      .verification-badge {
        padding: 0.4rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
      }

      .verified {
        background: rgba(57, 255, 20, 0.1);
        color: var(--success);
        border: 1px solid var(--success);
        box-shadow: 0 0 5px rgba(57, 255, 20, 0.3);
      }

      .unverified {
        background: rgba(255, 77, 77, 0.1);
        color: var(--error);
        border: 1px solid var(--error);
        box-shadow: 0 0 5px rgba(255, 77, 77, 0.3);
      }

      .warning-badge {
        background: rgba(255, 170, 0, 0.1);
        color: var(--warning);
        border: 1px solid var(--warning);
        box-shadow: 0 0 5px rgba(255, 170, 0, 0.3);
      }

      .risk-meter {
        height: 12px;
        background: var(--border);
        border-radius: 6px;
        margin: 1rem 0;
        overflow: hidden;
        border: 1px solid var(--border);
      }

      .risk-level {
        height: 100%;
        border-radius: 6px;
        background: linear-gradient(90deg, var(--success) 0%, var(--warning) 50%, var(--error) 100%);
        transition: width 0.5s ease;
      }

      .risk-factors {
        background: rgba(255, 170, 0, 0.1);
        padding: 1.25rem;
        border-radius: 8px;
        border-left: 4px solid var(--warning);
        margin-top: 1rem;
        box-shadow: 0 0 5px rgba(255, 170, 0, 0.3);
      }

      .summary-box {
        background: var(--card-bg);
        padding: 1.75rem;
        border-radius: 12px;
        border-left: 4px solid var(--primary);
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      .summary-box h3 {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--primary);
        margin: 0 0 1rem;
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      .coming-soon-alert {
        background: rgba(255, 170, 0, 0.1);
        padding: 1.25rem;
        border-radius: 8px;
        border-left: 4px solid var(--warning);
        display: flex;
        align-items: center;
        font-weight: 500;
        margin-bottom: 1.5rem;
        box-shadow: 0 0 5px rgba(255, 170, 0, 0.3);
      }

      .coming-soon-alert:before {
        content: "🚧";
        font-size: 1.75rem;
        margin-right: 1rem;
      }

      .results-grid {
        display: grid;
        gap: 1.5rem;
        grid-template-columns: 1fr;
      }

      .section-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--primary);
        margin: 2rem 0 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid var(--border);
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      .collapsible {
        background: var(--card-bg);
        border-radius: 12px;
        margin-bottom: 1rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      .collapsible-header {
        padding: 1.25rem 1.75rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .collapsible-header:hover {
        background: rgba(255, 111, 97, 0.1);
      }

      .collapsible-header h3 {
        margin: 0;
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--primary);
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      .collapsible-content {
        padding: 0 1.75rem 1.75rem;
        display: none;
      }

      .collapsible.open .collapsible-header {
        border-bottom: 1px solid var(--border);
      }

      .collapsible.open .collapsible-content {
        display: block;
      }

      .expand-icon::after {
        content: "+";
        font-size: 1.5rem;
        font-weight: 600;
        transition: transform 0.3s ease;
        color: var(--primary);
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      .collapsible.open .expand-icon::after {
        content: "−";
        transform: rotate(180deg);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 1rem 0;
      }

      th {
        padding: 1rem;
        background: rgba(255, 111, 97, 0.1);
        font-weight: 600;
        text-align: left;
        color: var(--primary);
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      td {
        padding: 1rem;
        border-bottom: 1px solid var(--border);
        color: var(--text);
      }

      tr:last-child td {
        border-bottom: none;
      }

      .nft-gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 1.5rem;
        margin-top: 1.5rem;
      }

      /* Footer Styles */
      footer {
        background: var(--card-bg);
        padding: 2rem 1.5rem;
        border-top: 1px solid var(--border);
        box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.3);
        width: 100%;
        z-index: 1;
      }

      .footer-content {
        max-width: 1280px;
        margin: 0 auto;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        gap: 2rem;
      }

      .footer-section {
        flex: 1;
        min-width: 250px;
      }

      .footer-section h4 {
        font-size: 1.2rem;
        font-weight: 600;
        color: var(--primary);
        margin-bottom: 1rem;
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      .footer-section p, .footer-section ul {
        font-size: 0.9rem;
        color: var(--text);
      }

      .footer-section ul {
        list-style: none;
        padding: 0;
      }

      .footer-section ul li {
        margin-bottom: 0.5rem;
      }

      .footer-section a {
        color: var(--secondary);
        text-decoration: none;
        transition: color 0.3s ease;
      }

      .footer-section a:hover {
        color: var(--primary);
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      .social-icons {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .social-icons a {
        font-size: 1.5rem;
        color: var(--text);
        transition: color 0.3s ease, transform 0.3s ease;
      }

      .social-icons a:hover {
        color: var(--primary);
        transform: scale(1.2);
        text-shadow: 0 0 5px rgba(255, 111, 97, 0.3);
      }

      .footer-bottom {
        text-align: center;
        margin-top: 2rem;
        font-size: 0.8rem;
        color: var(--text);
        opacity: 0.7;
      }

      @media (min-width: 768px) {
        .results-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 768px) {
        .container {
          padding: 1.5rem;
        }

        .tabs {
          flex-direction: column;
          align-items: stretch;
        }

        .tab {
          padding: 1rem;
          border-radius: 8px;
        }

        .tab-content {
          padding: 1.5rem;
        }

        .nft-gallery {
          grid-template-columns: 1fr;
        }

        h1 {
          font-size: 2.5rem;
        }

        .footer-content {
          flex-direction: column;
          gap: 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>NFT Verifier</h1>
    </header>
    
    <div class="container">
      <div class="tabs">
        <button class="tab active" data-tab="owner">Verify by Owner</button>
        <button class="tab" data-tab="collection">Verify by Collection</button>
        <button class="tab" data-tab="nft">Verify Single NFT</button>
      </div>

      <!-- Verify by Owner Tab -->
      <div id="owner-tab" class="tab-content active">
        <form id="owner-form">
          <div class="form-group">
            <label for="owner-address">Owner Address</label>
            <input
              type="text"
              id="owner-address"
              placeholder="Enter owner wallet address"
              required
            />
          </div>
          <button type="submit">Verify NFTs</button>
        </form>
      </div>

      <!-- Verify by Collection Tab -->
      <div id="collection-tab" class="tab-content">
        <div class="coming-soon-alert">This feature is coming soon! We're working hard to bring you collection verification.</div>
        <form id="collection-form">
          <div class="form-group">
            <label for="creator-address">Creator Address</label>
            <input
              type="text"
              id="creator-address"
              placeholder="Enter creator wallet address"
              required
              disabled
            />
          </div>
          <div class="form-group">
            <label for="collection-name">Collection Name</label>
            <input
              type="text"
              id="collection-name"
              placeholder="Enter collection name"
              required
              disabled
            />
          </div>
          <div class="form-group">
            <label for="collection-token-id">Token ID (Optional)</label>
            <input
              type="text"
              id="collection-token-id"
              placeholder="Enter specific token ID (optional)"
              disabled
            />
          </div>
          <button type="submit" disabled>Verify Collection</button>
        </form>
      </div>

      <!-- Verify Single NFT Tab -->
      <div id="nft-tab" class="tab-content">
        <div class="coming-soon-alert">This feature is coming soon! We're working hard to bring you single NFT verification.</div>
        <form id="nft-form">
          <div class="form-group">
            <label for="nft-owner-address">Owner Address (Optional)</label>
            <input
              type="text"
              id="nft-owner-address"
              placeholder="Enter owner wallet address"
              disabled
            />
          </div>
          <div class="form-group">
            <label for="nft-creator-address">Creator Address (Optional)</label>
            <input
              type="text"
              id="nft-creator-address"
              placeholder="Enter creator wallet address"
              disabled
            />
          </div>
          <div class="form-group">
            <label for="nft-collection-name">Collection Name (Optional)</label>
            <input
              type="text"
              id="nft-collection-name"
              placeholder="Enter collection name"
              disabled
            />
          </div>
          <div class="form-group">
            <label for="nft-token-id">Token ID (Optional)</label>
            <input type="text" id="nft-token-id" placeholder="Enter token ID" disabled />
          </div>
          <div class="error" id="nft-form-error"></div>
          <button type="submit" disabled>Verify NFT</button>
        </form>
      </div>

      <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p>Verifying NFT data...</p>
      </div>

      <div class="result" id="result">
        <h2>Verification Results</h2>
        <div id="result-content" class="results-grid"></div>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      <div class="footer-content">
        <div class="footer-section">
          <h4>About NFT Verifier</h4>
          <p>
            NFT Verifier is a cutting-edge tool designed to help users verify the authenticity and security of NFTs in the Web3 ecosystem. Built with a focus on transparency and user experience, it allows you to verify NFTs by owner, collection, or single token, with detailed risk assessments.
          </p>
        </div>
        <div class="footer-section">
          <h4>How It Works</h4>
          <p>
            Simply input a wallet address, collection name, or token ID to verify NFTs. Our system integrates with blockchain APIs to fetch real-time data, analyze it for risks, and present the results in an intuitive, futuristic UI. Features like risk meters and collapsible sections make it easy to understand the verification results.
          </p>
        </div>
        <div class="footer-section">
          <h4>Our Team</h4>
          <ul>
            <li>Alex Smith - Lead Developer</li>
            <li>Sarah Johnson - UI/UX Designer</li>
            <li>Michael Chen - Blockchain Specialist</li>
            <li>Emily Davis - Project Manager</li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Connect With Us</h4>
          <div class="social-icons">
            <a href="https://twitter.com/nftverifier" target="_blank">🐦</a>
            <a href="https://github.com/nftverifier" target="_blank">🐙</a>
            <a href="https://discord.gg/nftverifier" target="_blank">💬</a>
            <a href="https://reddit.com/r/nftverifier" target="_blank">👽</a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>© 2025 NFT Verifier • All Rights Reserved</p>
      </div>
    </footer>

    <script>
      // Base URL for your API
      const API_BASE_URL = "/verify"; // Adjust based on your deployment

      // Tab switching functionality
      document.querySelectorAll(".tab").forEach((tab) => {
        tab.addEventListener("click", () => {
          // Remove active class from all tabs and content
          document
            .querySelectorAll(".tab")
            .forEach((t) => t.classList.remove("active"));
          document
            .querySelectorAll(".tab-content")
            .forEach((c) => c.classList.remove("active"));

          // Add active class to clicked tab
          tab.classList.add("active");

          // Show corresponding content
          const tabId = tab.getAttribute("data-tab");
          document.getElementById(`${tabId}-tab`).classList.add("active");

          // Hide results when switching tabs
          document.getElementById("result").style.display = "none";
        });
      });

      // Owner verification form
      document
        .getElementById("owner-form")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          const ownerAddress = document
            .getElementById("owner-address")
            .value.trim();

          if (!ownerAddress) {
            showError("Please enter an owner address");
            return;
          }

          showLoading();

          try {
            const response = await axios.get(
              `${API_BASE_URL}/owner/${ownerAddress}`
            );
            displayResults(response.data);
          } catch (error) {
            handleError(error);
          } finally {
            hideLoading();
          }
        });

      // Collection verification form
      document
        .getElementById("collection-form")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          const creatorAddress = document
            .getElementById("creator-address")
            .value.trim();
          const collectionName = document
            .getElementById("collection-name")
            .value.trim();
          const tokenId = document
            .getElementById("collection-token-id")
            .value.trim();

          if (!creatorAddress || !collectionName) {
            showError("Please enter both creator address and collection name");
            return;
          }

          showLoading();

          try {
            let url = `${API_BASE_URL}/collection?creator_address=${encodeURIComponent(
              creatorAddress
            )}&collection_name=${encodeURIComponent(collectionName)}`;

            if (tokenId) {
              url += `&token_id=${encodeURIComponent(tokenId)}`;
            }

            const response = await axios.get(url);
            displayResults(response.data);
          } catch (error) {
            handleError(error);
          } finally {
            hideLoading();
          }
        });

      // Single NFT verification form
      document
        .getElementById("nft-form")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          const ownerAddress = document
            .getElementById("nft-owner-address")
            .value.trim();
          const creatorAddress = document
            .getElementById("nft-creator-address")
            .value.trim();
          const collectionName = document
            .getElementById("nft-collection-name")
            .value.trim();
          const tokenId = document.getElementById("nft-token-id").value.trim();

          // Clear previous errors
          document.getElementById("nft-form-error").textContent = "";

          // Check if minimum required fields are provided
          if (!ownerAddress && !(creatorAddress && collectionName)) {
            document.getElementById("nft-form-error").textContent =
              "Please provide either an owner address or both creator address and collection name";
            return;
          }

          showLoading();

          try {
            let url = `${API_BASE_URL}/nft?`;

            if (ownerAddress)
              url += `owner_address=${encodeURIComponent(ownerAddress)}&`;
            if (creatorAddress)
              url += `creator_address=${encodeURIComponent(creatorAddress)}&`;
            if (collectionName)
              url += `collection_name=${encodeURIComponent(collectionName)}&`;
            if (tokenId) url += `token_id=${encodeURIComponent(tokenId)}&`;

            // Remove trailing '&'
            url = url.slice(0, -1);

            const response = await axios.get(url);
            displayResults(response.data);
          } catch (error) {
            handleError(error);
          } finally {
            hideLoading();
          }
        });

      // Helper functions
      function showLoading() {
        document.getElementById("loading").style.display = "block";
        document.getElementById("result").style.display = "none";
      }

      function hideLoading() {
        document.getElementById("loading").style.display = "none";
      }

      function showError(message) {
        const resultDiv = document.getElementById("result");
        const resultContent = document.getElementById("result-content");

        resultContent.innerHTML = `<div class="error">${message}</div>`;
        resultDiv.style.display = "block";
      }

      function handleError(error) {
        let errorMessage = "An unexpected error occurred";

        if (error.response) {
          // The request was made and the server responded with an error status
          if (error.response.data && error.response.data.detail) {
            errorMessage = error.response.data.detail;
          } else {
            errorMessage = `Error: ${error.response.status} - ${error.response.statusText}`;
          }
        } else if (error.request) {
          // The request was made but no response was received
          errorMessage =
            "No response received from server. Please check your connection.";
        } else {
          // Something else caused the error
          errorMessage = error.message || errorMessage;
        }

        showError(errorMessage);
      }

      // Create a collapsible section
      function createCollapsible(title, content, isOpen = false) {
        const section = document.createElement('div');
        section.className = `collapsible ${isOpen ? 'open' : ''}`;
        
        const header = document.createElement('div');
        header.className = 'collapsible-header';
        header.innerHTML = `<h3>${title}</h3><span class="expand-icon"></span>`;
        
        const contentDiv = document.createElement('div');
        contentDiv.className = 'collapsible-content';
        contentDiv.innerHTML = content;
        
        section.appendChild(header);
        section.appendChild(contentDiv);
        
        header.addEventListener('click', () => {
          section.classList.toggle('open');
        });
        
        return section;
      }

      // Render verification badge based on verification status
      function renderVerificationBadge(isVerified, isHighRisk) {
        if (isVerified === true) {
          return `<div class="verification-badge verified">Verified ✓</div>`;
        } else if (isHighRisk === true) {
          return `<div class="verification-badge unverified">High Risk ⚠️</div>`;
        } else if (isVerified === false) {
          return `<div class="verification-badge unverified">Unverified ✗</div>`;
        } else {
          return `<div class="verification-badge warning-badge">Unknown Status</div>`;
        }
      }

      // Render risk meter
      function renderRiskMeter(riskScore) {
        if (riskScore === undefined) return "";

        // Cap risk score at 100
        const score = Math.min(Math.max(riskScore, 0), 100);
        const riskText = score < 30 ? "Low risk" : score < 70 ? "Medium risk" : "High risk";

        return `
                <div>
                    <p><strong>Risk Score:</strong> ${score}/100 <span style="font-weight: 500; color: ${
                      score < 30 ? "var(--success)" : score < 70 ? "var(--warning)" : "var(--error)"
                    }">(${riskText})</span></p>
                    <div class="risk-meter">
                        <div class="risk-level" style="width: ${score}%"></div>
                    </div>
                </div>
            `;
      }

      // Render risk factors
      function renderRiskFactors(factors) {
        if (!factors || factors.length === 0) return "";

        const factorDescriptions = {
          INCOMPLETE_METADATA: "NFT is missing essential metadata",
          HIGH_TRANSFER_VELOCITY:
            "NFT has been transferred multiple times in a short period",
          NEW_CREATOR_ACCOUNT: "Creator account is less than 30 days old",
          ZERO_SUPPLY: "Collection has zero supply",
          VERY_LOW_SUPPLY: "Collection has very low supply",
          SUSPICIOUS_ACTIVITY: "Suspicious activity detected",
        };

        let factorsList = factors
          .map((factor) => {
            return `<li>${factorDescriptions[factor] || factor}</li>`;
          })
          .join("");

        return `
                <div class="risk-factors">
                    <strong>Risk Factors Detected:</strong>
                    <ul>${factorsList}</ul>
                </div>
            `;
      }

      // Render scammer warning
      function renderScammerWarning(isScammer) {
        if (!isScammer) return "";

        return `
                <div class="error" style="padding: 1rem; margin: 1rem 0; background-color: rgba(255, 77, 77, 0.1); border-radius: 0.5rem;">
                    <strong>⚠️ WARNING:</strong> This address is flagged in our database of known scammers!
                </div>
            `;
      }

      function displayResults(data) {
        const resultDiv = document.getElementById("result");
        const resultContent = document.getElementById("result-content");

        // Clear previous results
        resultContent.innerHTML = "";

        // Owner verification summary (if applicable)
        if (data.owner_address) {
          const accountSection = document.createElement('div');
          accountSection.className = 'summary-box';
          
          let accountContent = `
              <h3>Account Information</h3>
              <p><strong>Address:</strong> ${data.owner_address}</p>
              ${renderScammerWarning(data.is_scammer)}
              ${
                data.verification_results
                  ? `<p><strong>Average Risk Score:</strong> 
                  ${
                    data.verification_results.average_risk_score
                      ? data.verification_results.average_risk_score.toFixed(
                          1
                        ) + "/100"
                      : "N/A"
                  }
                  </p>`
                  : ""
              }
              ${
                data.verification_results &&
                data.verification_results.is_verified !== undefined
                  ? renderVerificationBadge(
                      data.verification_results.is_verified,
                      false
                    )
                  : ""
              }
              ${
                data.verification_results &&
                data.verification_results.verification_timestamp
                  ? `<p><small>Verified on: ${new Date(
                      data.verification_results.verification_timestamp
                    ).toLocaleString()}</small></p>`
                  : ""
              }
          `;
          
          accountSection.innerHTML = accountContent;
          resultContent.appendChild(accountSection);

          // Token Balances Section
          if (data.token_balances && data.token_balances.length > 0) {
            let balancesContent = `
                <h3>Token/Coin Balances</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Token</th>
                            <th>Balance</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.token_balances
                          .map(
                            (token) => `
                            <tr>
                                <td>${token.name}</td>
                                <td>${formatNumber(token.amount)}</td>
                            </tr>
                        `
                          )
                          .join("")}
                    </tbody>
                </table>
            `;
            
            const balancesSection = createCollapsible('Token Balances', balancesContent);
            resultContent.appendChild(balancesSection);
          }

          // Account Activities Section
          if (data.account_activities) {
            const activities = data.account_activities;
            resultContent.innerHTML += `
                <div class="summary-box">
                    <h3>Account Activities</h3>
                    <ul>
                        ${
                          activities.nft_staking
                            ? `<li>Has participated in NFT staking</li>`
                            : `<li>Has not participated in NFT staking</li>`
                        }
                        <li>Has participated in token swaps (${
                          activities.token_swaps.listing_count
                        } listing events, 
                            ${
                              activities.token_swaps.swap_count
                            } swap events)</li>
                        <li>Has had NFT transfers (deposit events: ${
                          activities.nft_transfers.deposit_count
                        }, 
                            withdraw events: ${
                              activities.nft_transfers.withdraw_count
                            })</li>
                        <li>Has made token property modifications (${
                          activities.property_modifications
                        } events)</li>
                    </ul>
                    
                    ${
                      activities.recent_transactions.length > 0
                        ? `
                        <h4 class="mt-4">Recent Transactions</h4>
                        <table class="w-full">
                            <thead>
                                <tr>
                                    <th class="text-left">Type</th>
                                    <th class="text-left">Time</th>
                                    <th class="text-left">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${activities.recent_transactions
                                  .map(
                                    (tx) => `
                                    <tr>
                                        <td>${tx.type}</td>
                                        <td>${formatDate(tx.timestamp)}</td>
                                        <td>${
                                          tx.success
                                            ? '<span class="verification-badge verified">Success</span>'
                                            : '<span class="verification-badge unverified">Failed</span>'
                                        }</td>
                                    </tr>
                                `
                                  )
                                  .join("")}
                            </tbody>
                        </table>
                    `
                        : ""
                    }
                </div>
            `;
          }
        }

        // Collection verification summary (if applicable)
        if (data.collection_name) {
          resultContent.innerHTML += `
            <div class="summary-box">
                <h3>Collection Verification Summary</h3>
                <p><strong>Collection:</strong> ${data.collection_name}</p>
                <p><strong>Creator:</strong> ${
                  data.creator_address || "N/A"
                }</p>
                ${renderScammerWarning(data.is_scammer)}
                ${
                  data.verification_results
                    ? renderVerificationBadge(
                        data.verification_results.is_verified,
                        data.verification_results.is_high_risk
                      )
                    : ""
                }
                ${
                  data.verification_results
                    ? renderRiskMeter(data.verification_results.risk_score)
                    : ""
                }
                ${
                  data.verification_results &&
                  data.verification_results.risk_factors
                    ? renderRiskFactors(data.verification_results.risk_factors)
                    : ""
                }
            </div>
        `;
        }

        // Display token-specific verification if available
        if (data.token_data && data.token_verification) {
          resultContent.innerHTML += `
            <div class="summary-box">
                <h3>Token Verification</h3>
                <p><strong>Token:</strong> ${
                  data.token_data.name || "N/A"
                } (ID: ${data.token_data.id || "N/A"})</p>
                ${renderVerificationBadge(
                  data.token_verification.is_verified,
                  data.token_verification.risk_assessment &&
                    data.token_verification.risk_assessment.is_high_risk
                )}
                ${
                  data.token_verification.risk_assessment
                    ? renderRiskMeter(
                        data.token_verification.risk_assessment.risk_score
                      )
                    : ""
                }
                ${
                  data.token_verification.risk_assessment &&
                  data.token_verification.risk_assessment.risk_factors
                    ? renderRiskFactors(
                        data.token_verification.risk_assessment.risk_factors
                      )
                    : ""
                }
                ${
                  data.token_verification.reason
                    ? `<p class="error"><strong>Reason:</strong> ${data.token_verification.reason}</p>`
                    : ""
                }
            </div>
        `;
        }

        // Display questionable NFTs if any
        if (
          data.verification_results &&
          data.verification_results.questionable_nfts &&
          data.verification_results.questionable_nfts.length > 0
        ) {
          resultContent.innerHTML += `<h3>Questionable NFTs</h3>`;

          data.verification_results.questionable_nfts.forEach((item) => {
            const nft = item.nft_data;
            const risk = item.risk_assessment;

            const questionableCard = document.createElement("div");
            questionableCard.className = "nft-card";

            let cardContent = `
                <div class="verification-badge unverified">High Risk ⚠️</div>
                <h3>${nft.name || "NFT information is secure"}</h3>
                <p><strong>Token ID:</strong> ${nft.id || "hiden"}</p>
                <p><strong>Collection:</strong> ${nft.collection || "hiden"}</p>
                <p><strong>Creator:</strong> ${nft.creator || "Permission Denied"}</p>
                ${renderRiskMeter(risk.risk_score)}
                ${renderRiskFactors(risk.risk_factors)}
            `;

            questionableCard.innerHTML = cardContent;
            resultContent.appendChild(questionableCard);
          });
        }

        // NFT listing
        if (data.nfts && data.nfts.length > 0) {
          // Create NFT holdings summary by collection
          const nftsByCollection = {};
          data.nfts.forEach((nft) => {
            const collection = nft.collection || "Uncategorized";
            if (!nftsByCollection[collection]) {
              nftsByCollection[collection] = [];
            }
            nftsByCollection[collection].push(nft);
          });

          // Display NFT holdings summary
          resultContent.innerHTML += `
            <div class="summary-box">
                <h3>NFT Holdings Summary</h3>
                <ul>
                    ${Object.entries(nftsByCollection)
                      .map(
                        ([collection, nfts]) => `
                        <li><strong>${collection}:</strong> ${nfts
                          .map(
                            (nft) => `${nft.name}${nft.id ? ` #${nft.id}` : ""}`
                          )
                          .join(", ")}</li>
                    `
                      )
                      .join("")}
                </ul>
            </div>
        `;

          // Display NFTs by owner (detailed view)
          resultContent.innerHTML += `<h3>Found ${data.nfts.length} NFT(s)</h3>`;

          data.nfts.forEach((nft) => {
            const nftCard = document.createElement("div");
            nftCard.className = "nft-card";

            // Check if this NFT is in the questionable list
            let isQuestionable = false;
            if (
              data.verification_results &&
              data.verification_results.questionable_nfts
            ) {
              isQuestionable = data.verification_results.questionable_nfts.some(
                (item) => item.nft_data.id === nft.id
              );
            }

            let cardContent = `
                ${!isQuestionable ? renderVerificationBadge(true, false) : ""}
                <h3>${nft.name || "NFT information is secure"}</h3>
                <p><strong>Token ID:</strong> ${nft.id || "Hiden"}</p>
                <p><strong>Collection:</strong> ${nft.collection || "Hiden"}</p>
                <p><strong>Creator:</strong> ${nft.creator || "Permission Denied"}</p>
            `;

            if (nft.uri) {
              cardContent += `<p><strong>URI:</strong> <a href="${nft.uri}" target="_blank">${nft.uri}</a></p>`;
            }

            if (nft.description) {
              cardContent += `<p><strong>Description:</strong> ${nft.description}</p>`;
            }

            if (nft.metadata) {
              cardContent += `<details>
                    <summary>Metadata</summary>
                    <pre>${JSON.stringify(nft.metadata, null, 2)}</pre>
                </details>`;
            }

            nftCard.innerHTML = cardContent;
            resultContent.appendChild(nftCard);
          });
        } else if (data.collection_data) {
          // Display collection data
          resultContent.innerHTML += `
            <h3>Collection: ${
              data.collection_data.name || "Unnamed Collection"
            }</h3>
            <p><strong>Creator:</strong> ${
              data.collection_data.creator || "N/A"
            }</p>
            <p><strong>Total Items:</strong> ${
              data.collection_data.total_items || "N/A"
            }</p>
        `;

          if (
            data.collection_data.items &&
            data.collection_data.items.length > 0
          ) {
            resultContent.innerHTML += `<h3>Collection Items</h3>`;

            data.collection_data.items.forEach((item) => {
              const itemCard = document.createElement("div");
              itemCard.className = "nft-card";

              let cardContent = `
                    <h3>${item.name || "Unnamed Item"}</h3>
                    <p><strong>Token ID:</strong> ${item.id || "N/A"}</p>
                    <p><strong>Owner:</strong> ${item.owner || "N/A"}</p>
                `;

              if (item.metadata) {
                cardContent += `<details>
                        <summary>Metadata</summary>
                        <pre>${JSON.stringify(item.metadata, null, 2)}</pre>
                    </details>`;
              }

              itemCard.innerHTML = cardContent;
              resultContent.appendChild(itemCard);
            });
          }

          if (data.collection_data.metadata) {
            resultContent.innerHTML += `
                <details>
                    <summary>Collection Metadata</summary>
                    <pre>${JSON.stringify(
                      data.collection_data.metadata,
                      null,
                      2
                    )}</pre>
                </details>
            `;
          }
        } else {
          // No data found
          resultContent.innerHTML =
            "<p>No NFT data found matching your criteria.</p>";
        }

        resultDiv.style.display = "block";
      }

      // Helper function to format numbers with commas
      function formatNumber(num) {
        if (num === undefined || num === null) return "N/A";

        // Convert to number if it's a string
        num = typeof num === "string" ? parseFloat(num) : num;

        // Format with commas
        return num.toLocaleString();
      }

      // Helper function to format dates
      function formatDate(dateString) {
        if (!dateString) return "N/A";

        try {
          const date = new Date(dateString);
          return date.toLocaleString();
        } catch (e) {
          return dateString;
        }
      }
    </script>
  </body>
</html>